using Newtonsoft.Json;
using System;
using System.IO;
using System.Windows.Forms;

namespace HRMConfiguration
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }


        const string CONNSTR_FILE = "data.dat";
        const string fn = "BangCong_Layout.xml";
        string XML => "<XtraSerializer version=\"1.0\" application=\"View\">\r\n  <property name=\"#LayoutVersion\" />\r\n  <property name=\"#LayoutScaleFactor\">@1,Width=1@1,Height=1</property>\r\n  <property name=\"Columns\" iskey=\"true\" value=\"42\">\r\n    <property name=\"Item1\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">0</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">ID</property>\r\n      <property name=\"Caption\">ID</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">IDLC</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">32</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item2\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">1</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">MAKYCONG</property>\r\n      <property name=\"Caption\">Mã Kỳ Công</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">MAKYCONG</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">90</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item3\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">3</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">MANV</property>\r\n      <property name=\"Caption\">Mã Nhân Viên</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">MANV</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">82</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item4\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">4</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">HOTEN</property>\r\n      <property name=\"Caption\">Họ Tên</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">HOTEN</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">86</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item5\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">2</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">TENPB</property>\r\n      <property name=\"Caption\">Phòng ban</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">TENPB</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">93</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item6\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">5</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day1</property>\r\n      <property name=\"Caption\">Day1</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day1</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">39</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item7\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">6</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day2</property>\r\n      <property name=\"Caption\">Day2</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day2</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">60</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item8\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">7</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day3</property>\r\n      <property name=\"Caption\">Day3</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day3</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">76</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item9\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">8</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day4</property>\r\n      <property name=\"Caption\">Day4</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day4</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item10\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">9</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day5</property>\r\n      <property name=\"Caption\">Day5</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day5</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item11\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">10</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day6</property>\r\n      <property name=\"Caption\">Day6</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day6</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item12\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">11</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day7</property>\r\n      <property name=\"Caption\">Day7</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day7</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item13\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">12</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day8</property>\r\n      <property name=\"Caption\">Day8</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day8</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item14\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">13</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day9</property>\r\n      <property name=\"Caption\">Day9</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day9</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item15\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">14</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day10</property>\r\n      <property name=\"Caption\">Day10</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day10</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item16\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">15</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day11</property>\r\n      <property name=\"Caption\">Day11</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day11</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item17\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">16</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day12</property>\r\n      <property name=\"Caption\">Day12</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day12</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item18\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">17</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day13</property>\r\n      <property name=\"Caption\">Day13</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day13</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item19\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">18</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day14</property>\r\n      <property name=\"Caption\">Day14</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day14</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item20\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">19</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day15</property>\r\n      <property name=\"Caption\">Day15</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day15</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item21\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">20</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day16</property>\r\n      <property name=\"Caption\">Day16</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day16</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item22\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">21</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day17</property>\r\n      <property name=\"Caption\">Day17</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day17</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item23\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">22</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day18</property>\r\n      <property name=\"Caption\">Day18</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day18</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item24\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">23</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day19</property>\r\n      <property name=\"Caption\">Day19</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day19</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item25\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">24</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day20</property>\r\n      <property name=\"Caption\">Day20</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day20</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item26\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">25</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day21</property>\r\n      <property name=\"Caption\">Day21</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day21</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item27\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">26</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day22</property>\r\n      <property name=\"Caption\">Day22</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day22</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item28\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">27</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day23</property>\r\n      <property name=\"Caption\">Day23</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day23</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item29\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">28</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day24</property>\r\n      <property name=\"Caption\">Day24</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day24</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item30\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">29</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day25</property>\r\n      <property name=\"Caption\">Day25</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day25</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item31\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">30</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day26</property>\r\n      <property name=\"Caption\">Day26</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day26</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item32\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">31</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day27</property>\r\n      <property name=\"Caption\">Day27</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day27</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item33\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">32</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day28</property>\r\n      <property name=\"Caption\">Day28</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day28</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item34\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">33</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day29</property>\r\n      <property name=\"Caption\">Day29</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day29</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item35\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">34</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day30</property>\r\n      <property name=\"Caption\">Day30</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day30</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item36\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">35</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">Day31</property>\r\n      <property name=\"Caption\">Day31</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">Day31</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">71</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item37\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">36</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">NGAYCONG</property>\r\n      <property name=\"Caption\">SỐ NGÀY CÔNG TRONG THÁNG</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">NGAYCONG</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">210</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item38\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">38</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">NGAYPHEP</property>\r\n      <property name=\"Caption\">NGÀY PHÉP</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">NGAYPHEP</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item39\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">37</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">NGHIKHONGPHEP</property>\r\n      <property name=\"Caption\">NGHỈ KHÔNG PHÉP</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">NGHIKHONGPHEP</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">34</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item40\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">39</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">CONGNGAYLE</property>\r\n      <property name=\"Caption\">CÔNG NGÀY LỄ</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">CONGNGAYLE</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item41\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">40</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">CONGCHUNHAT</property>\r\n      <property name=\"Caption\">CÔNG CN</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">CONGCHUNHAT</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n    <property name=\"Item42\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"VisibleIndex\">41</property>\r\n      <property name=\"Fixed\">None</property>\r\n      <property name=\"Name\">TONGNGAYCONG</property>\r\n      <property name=\"Caption\">TỔNG NGÀY CÔNG</property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"FieldName\">TONGNGAYCONG</property>\r\n      <property name=\"ColumnEditName\" />\r\n      <property name=\"Visible\">true</property>\r\n      <property name=\"Width\">25</property>\r\n      <property name=\"MinWidth\">25</property>\r\n      <property name=\"UnboundDataTypeName\" />\r\n    </property>\r\n  </property>\r\n  <property name=\"MinBandPanelRowCount\">1</property>\r\n  <property name=\"OptionsView\" isnull=\"true\" iskey=\"true\">\r\n    <property name=\"ShowGroupPanel\">false</property>\r\n  </property>\r\n  <property name=\"BandPanelRowHeight\">-1</property>\r\n  <property name=\"FixedLineWidth\">2</property>\r\n  <property name=\"IndicatorWidth\">-1</property>\r\n  <property name=\"ColumnPanelRowHeight\">-1</property>\r\n  <property name=\"RowSeparatorHeight\">0</property>\r\n  <property name=\"FooterPanelHeight\">-1</property>\r\n  <property name=\"HorzScrollVisibility\">Auto</property>\r\n  <property name=\"VertScrollVisibility\">Auto</property>\r\n  <property name=\"RowHeight\">-1</property>\r\n  <property name=\"GroupRowHeight\">-1</property>\r\n  <property name=\"GroupFormat\">{0}: [#image]{1} {2}</property>\r\n  <property name=\"ChildGridLevelName\" />\r\n  <property name=\"VertScrollTipFieldName\" />\r\n  <property name=\"PreviewFieldName\" />\r\n  <property name=\"GroupPanelText\" />\r\n  <property name=\"NewItemRowText\" />\r\n  <property name=\"LevelIndent\">-1</property>\r\n  <property name=\"PreviewIndent\">-1</property>\r\n  <property name=\"PreviewLineCount\">-1</property>\r\n  <property name=\"ScrollStyle\">LiveVertScroll, LiveHorzScroll</property>\r\n  <property name=\"FocusRectStyle\">CellFocus</property>\r\n  <property name=\"HorzScrollStep\">0</property>\r\n  <property name=\"ActiveFilterEnabled\">true</property>\r\n  <property name=\"ViewCaptionHeight\">-1</property>\r\n  <property name=\"ViewCaption\" />\r\n  <property name=\"BorderStyle\">Default</property>\r\n  <property name=\"SynchronizeClones\">true</property>\r\n  <property name=\"DetailTabHeaderLocation\">Top</property>\r\n  <property name=\"Name\">gvBangCongChiTiet</property>\r\n  <property name=\"DetailHeight\">350</property>\r\n  <property name=\"Tag\" isnull=\"true\" />\r\n  <property name=\"Bands\" iskey=\"true\" value=\"2\">\r\n    <property name=\"Item1\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"AppearanceHeader\" isnull=\"true\" iskey=\"true\">\r\n        <property name=\"Options\" isnull=\"true\" iskey=\"true\">\r\n          <property name=\"UseBackColor\">true</property>\r\n          <property name=\"UseFont\">true</property>\r\n        </property>\r\n        <property name=\"BackColor\">DarkMagenta</property>\r\n        <property name=\"Font\">Tahoma, 12pt, style=Bold, Italic</property>\r\n      </property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"Fixed\">Left</property>\r\n      <property name=\"Width\">383</property>\r\n      <property name=\"MinWidth\">10</property>\r\n      <property name=\"Columns\" iskey=\"true\" value=\"5\">\r\n        <property name=\"Item1\">ID</property>\r\n        <property name=\"Item2\">MAKYCONG</property>\r\n        <property name=\"Item3\">TENPB</property>\r\n        <property name=\"Item4\">MANV</property>\r\n        <property name=\"Item5\">HOTEN</property>\r\n      </property>\r\n      <property name=\"Children\" iskey=\"true\" value=\"0\" />\r\n      <property name=\"Caption\">THÔNG TIN NHÂN VIÊN</property>\r\n      <property name=\"Name\">THONGTINNHANVIEN</property>\r\n    </property>\r\n    <property name=\"Item2\" isnull=\"true\" iskey=\"true\">\r\n      <property name=\"AppearanceHeader\" isnull=\"true\" iskey=\"true\">\r\n        <property name=\"Options\" isnull=\"true\" iskey=\"true\">\r\n          <property name=\"UseBackColor\">true</property>\r\n          <property name=\"UseFont\">true</property>\r\n        </property>\r\n        <property name=\"BackColor\">MediumSpringGreen</property>\r\n        <property name=\"Font\">Tahoma, 12pt, style=Bold, Italic</property>\r\n      </property>\r\n      <property name=\"ImageAlignment\">Near</property>\r\n      <property name=\"ImageIndex\">-1</property>\r\n      <property name=\"Width\">1265</property>\r\n      <property name=\"MinWidth\">10</property>\r\n      <property name=\"Columns\" iskey=\"true\" value=\"37\">\r\n        <property name=\"Item1\">Day1</property>\r\n        <property name=\"Item2\">Day2</property>\r\n        <property name=\"Item3\">Day3</property>\r\n        <property name=\"Item4\">Day4</property>\r\n        <property name=\"Item5\">Day5</property>\r\n        <property name=\"Item6\">Day6</property>\r\n        <property name=\"Item7\">Day7</property>\r\n        <property name=\"Item8\">Day8</property>\r\n        <property name=\"Item9\">Day9</property>\r\n        <property name=\"Item10\">Day10</property>\r\n        <property name=\"Item11\">Day11</property>\r\n        <property name=\"Item12\">Day12</property>\r\n        <property name=\"Item13\">Day13</property>\r\n        <property name=\"Item14\">Day14</property>\r\n        <property name=\"Item15\">Day15</property>\r\n        <property name=\"Item16\">Day16</property>\r\n        <property name=\"Item17\">Day17</property>\r\n        <property name=\"Item18\">Day18</property>\r\n        <property name=\"Item19\">Day19</property>\r\n        <property name=\"Item20\">Day20</property>\r\n        <property name=\"Item21\">Day21</property>\r\n        <property name=\"Item22\">Day22</property>\r\n        <property name=\"Item23\">Day23</property>\r\n        <property name=\"Item24\">Day24</property>\r\n        <property name=\"Item25\">Day25</property>\r\n        <property name=\"Item26\">Day26</property>\r\n        <property name=\"Item27\">Day27</property>\r\n        <property name=\"Item28\">Day28</property>\r\n        <property name=\"Item29\">Day29</property>\r\n        <property name=\"Item30\">Day30</property>\r\n        <property name=\"Item31\">Day31</property>\r\n        <property name=\"Item32\">NGAYCONG</property>\r\n        <property name=\"Item33\">NGHIKHONGPHEP</property>\r\n        <property name=\"Item34\">NGAYPHEP</property>\r\n        <property name=\"Item35\">CONGNGAYLE</property>\r\n        <property name=\"Item36\">CONGCHUNHAT</property>\r\n        <property name=\"Item37\">TONGNGAYCONG</property>\r\n      </property>\r\n      <property name=\"Children\" iskey=\"true\" value=\"0\" />\r\n      <property name=\"Caption\">CHI TIẾT NGÀY CÔNG</property>\r\n      <property name=\"Name\">CHITIETNGAYCONG</property>\r\n    </property>\r\n  </property>\r\n  <property name=\"GroupSummary\" iskey=\"true\" value=\"0\" />\r\n  <property name=\"ActiveFilterString\" />\r\n  <property name=\"FormatRules\" iskey=\"true\" value=\"0\" />\r\n  <property name=\"FormatConditions\" iskey=\"true\" value=\"0\" />\r\n  <property name=\"GroupSummarySortInfoState\" />\r\n  <property name=\"FindFilterText\" />\r\n  <property name=\"FindPanelVisible\">false</property>\r\n</XtraSerializer>";

        void GetSqlDropDown()
        {
            string ServerName = Environment.MachineName;
            Microsoft.Win32.RegistryView registryView = Environment.Is64BitOperatingSystem ? Microsoft.Win32.RegistryView.Registry64 : Microsoft.Win32.RegistryView.Registry32;
            using (Microsoft.Win32.RegistryKey hklm = Microsoft.Win32.RegistryKey.OpenBaseKey(Microsoft.Win32.RegistryHive.LocalMachine, registryView))
            {
                Microsoft.Win32.RegistryKey instanceKey = hklm.OpenSubKey(@"SOFTWARE\Microsoft\Microsoft SQL Server\Instance Names\SQL", false);
                if (instanceKey != null)
                {
                    foreach (var instanceName in instanceKey.GetValueNames())
                    {
                        if (instanceName == "MSSQLSERVER")
                        {
                            cbSql.Items.Add(ServerName);

                        }
                        else
                        {
                            cbSql.Items.Add(ServerName + "\\" + instanceName);
                        }
                    }

                    if (cbSql.Items.Count > 0)
                    {
                        cbSql.SelectedIndex = 0;
                    }
                }
            }
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            GetSqlDropDown();

            chkSqlIntegratedSecurity_CheckedChanged(null, null);
        }

        private void chkSqlIntegratedSecurity_CheckedChanged(object sender, EventArgs e)
        {
            if (chkSqlIntegratedSecurity.Checked)
            {
                txtSqlPassword.Enabled = txtSqlUserName.Enabled = false;
            }
            else
            {
                txtSqlPassword.Enabled = txtSqlUserName.Enabled = true;
            }
        }





        private void button1_Click(object sender, EventArgs e)
        {
            if (File.Exists(fn) == false)
            {
                File.WriteAllText(fn, XML);
            }

            Login_Sql_Model login = new Login_Sql_Model();

            login.ServerName = cbSql.Text.Trim();
            login.DatabaseName = txtSqlDatabaseName.Text.Trim();
            login.UserName = txtSqlUserName.Text.Trim();
            login.Password = txtSqlPassword.Text.Trim();
            login.IntegratedSecurity = chkSqlIntegratedSecurity.Checked;

            Session.CONN_STR_INIT = login.CONNSTR_INIT;
            Session.CONN_STR = login.CONNSTR;

            Init init = new Init();
            bool res = init.SetupDB(login.DatabaseName, out string Err);

            if (res)
            {
                string LoginSqlInfoJson = JsonConvert.SerializeObject(login);

                string hashedCONN = StringCipher.Encrypt(LoginSqlInfoJson);

                //sau khi thiet lap data thanh cong moi luu conn
                System.IO.File.WriteAllText(CONNSTR_FILE, hashedCONN);

                //day la dang nhap lan dau nen cai script ở đây
                var dlg = MessageBox.Show("Đã tạo thành công cơ sở dữ liệu mẫu.\r\nBạn có muốn sử dụng HRM ngay bây giờ không?", "Thông báo", MessageBoxButtons.YesNo, MessageBoxIcon.Information);

                if (dlg == DialogResult.Yes)
                {
                    if(File.Exists("HRM.exe"))
                    {
                        System.Diagnostics.Process.Start("HRM.exe");
                    }
                    else
                    {
                        MessageBox.Show("không tìm thấy file HRM.exe\r\nVui lòng liên hệ người quản trị.", "Lỗi", MessageBoxButtons.OK, MessageBoxIcon.Error);
                    }
                }

                Application.Exit();
            }
        }
    }
}
